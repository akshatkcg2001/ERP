"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[129],{8129:(q,h,i)=>{i.r(h),i.d(h,{LinkSaleModule:()=>$});var c=i(6814),F=i(6208),b=i(6472),m=i(3838),M=i(2524),T=i(1088),d=i(9772),r=i(95),J=i(7398),u=i(9397),N=i(7101),p=i(694);function S({saleMasterId:s=0,voucherId:a=0}){return{saleMasterId:s,voucherId:a}}var e=i(9468),Y=i(2051),f=i(6232),g=i(6306),x=i(8154),O=i(7283);let Q=(()=>{class s{constructor(t,o,n){this.router=t,this.CarpetInventoryService=o,this.messageService=n}upsertLinkSale(t){return this.CarpetInventoryService.patchLinkSaleVoucher(t).pipe((0,g.K)(o=>(this.messageService.error("Error on getting sales:"),f.E)),(0,u.b)(o=>{this.messageService.success("Sale and Voucher Linked Successfully")}))}deleteLinkSale(t){return this.CarpetInventoryService.deleteLinkSaleVoucher(t).pipe((0,g.K)(o=>(this.messageService.error("Error on getting sales:"),f.E)),(0,u.b)(o=>{this.messageService.success("Link Deleted Successfully")}))}static#e=this.\u0275fac=function(o){return new(o||s)(e.LFG(d.F0),e.LFG(x.F),e.LFG(O.H))};static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var L=i(5042),C=i(4141),I=i(3719),y=i(5051),k=i(5056),U=i(4006);function B(s,a){if(1&s&&(e.TgZ(0,"option",15),e._uU(1),e.ALo(2,"titlecase"),e.ALo(3,"async"),e.ALo(4,"getClientNameById"),e.ALo(5,"titlecase"),e.qZA()),2&s){const t=a.$implicit;e.s9C("value",t.id),e.xp6(1),e.Oqu(t.orderNumber+" - "+e.lcZ(2,2,e.lcZ(3,4,e.lcZ(4,6,t.customerId)))+" - "+e.lcZ(5,8,t.country))}}function E(s,a){if(1&s&&(e.TgZ(0,"option",15),e._uU(1),e.qZA()),2&s){const t=a.$implicit;e.s9C("value",t.id),e.xp6(1),e.Oqu(t.voucherCode+"/ "+t.companyName)}}function V(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"div",1)(2,"app-card",2)(3,"form",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"label",7),e._uU(8,"Order Number"),e.qZA(),e.TgZ(9,"select",8)(10,"option",9),e._uU(11,"Select"),e.qZA(),e.YNc(12,B,6,10,"option",10),e.qZA()(),e.TgZ(13,"button",11),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.linkSaleClick())}),e._uU(14,"Save"),e.qZA(),e.TgZ(15,"button",12),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openDeleteConfirmationModal())}),e._uU(16,"Remove"),e.qZA()(),e.TgZ(17,"div",5)(18,"div",6)(19,"label",13),e._uU(20,"Voucher Code"),e.qZA(),e.TgZ(21,"select",14)(22,"option",9),e._uU(23,"Select"),e.qZA(),e.YNc(24,E,2,2,"option",10),e.qZA()()()()()()()()}if(2&s){const t=a.ngIf,o=e.oxw();e.xp6(2),e.Q6J("hidHeader",!1)("options",!1),e.xp6(1),e.Q6J("formGroup",o.linkSaleForm),e.xp6(9),e.Q6J("ngForOf",t.saleList),e.xp6(1),e.Q6J("disabled",o.linkSaleForm.invalid),e.xp6(2),e.Q6J("disabled",null==o.saleMasterId.errors?null:o.saleMasterId.errors.min),e.xp6(9),e.Q6J("ngForOf",t.voucherList)}}const Z=function(){return[]},D=function(s,a){return{saleList:s,voucherList:a}},G=[{path:"",component:(()=>{class s{get saleMasterId(){return this.linkSaleForm.get("saleMasterId")}get voucherId(){return this.linkSaleForm.get("voucherId")}constructor(t,o,n,l,v,A,z,R,j){this.router=t,this.formBuilder=o,this.modalService=n,this.linkSaleService=l,this.saleStore=v,this.saleService=A,this.voucherStore=z,this.voucherService=R,this.userService=j,this.pagingConfig=(0,N.F)({}),this.active=1,this.rowCheckedState={},this.selectedIds=[],this.saleList$=this.saleStore.selectAll(),this.voucherList$=this.voucherStore.selectAll().pipe((0,J.U)(P=>P.sort((X,W)=>W.id-X.id))),this.subscriptions=[],this.linkSaleForm=this.formBuilder.nonNullable.group({saleMasterId:[0,[r.kI.required,r.kI.min(1)]],voucherId:[0,[r.kI.required,r.kI.min(1)]]})}ngOnInit(){this.subscriptions.push(this.saleService.getAll().subscribe(),this.voucherService.getAll().subscribe(),this.userService.getAll().subscribe())}navigatePendingPayment(t=0){this.router.navigate(["pending-payment/pending",t])}linkSaleClick(){const t=S({saleMasterId:this.saleMasterId.value,voucherId:this.voucherId.value});this.subscriptions.push(this.linkSaleService.upsertLinkSale(t).pipe((0,u.b)(o=>{o&&this.clear()})).subscribe())}openDeleteConfirmationModal(){const t={message:"Remove Voucher From Sale",modalType:p.w.Confirmation},n=this.modalService.show(p.b,{initialState:t,class:"modal-sm modal-dialog-centered"}).content?.onClose.pipe((0,u.b)(l=>{if(l){const v=S({saleMasterId:this.saleMasterId.value});this.linkSaleService.deleteLinkSale(v).pipe((0,u.b)(A=>{this.clear()})).subscribe()}})).subscribe();n&&this.subscriptions.push(n)}clear(){this.saleMasterId.setValue(0),this.voucherId.setValue(0)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static#e=this.\u0275fac=function(o){return new(o||s)(e.Y36(d.F0),e.Y36(r.qu),e.Y36(Y.tT),e.Y36(Q),e.Y36(L.Q),e.Y36(C.F),e.Y36(I.Z),e.Y36(y.H),e.Y36(k.K))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-link-sale"]],decls:3,vars:10,consts:[[4,"ngIf"],[1,"col-md-12"],["cardTitle","Link Sale with Voucher",3,"hidHeader","options"],[3,"formGroup"],[1,"row"],[1,"col-md-6"],[1,"form-group"],["for","orderNumber"],["id","orderNumber","formControlName","saleMasterId",1,"form-control"],["value","0"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary","m-r-10",3,"disabled","click"],[1,"btn","btn-primary",3,"disabled","click"],["for","voucherCode"],["id","voucherCode","formControlName","voucherId",1,"form-control"],[3,"value"]],template:function(o,n){if(1&o&&(e.YNc(0,V,25,7,"div",0),e.ALo(1,"async"),e.ALo(2,"async")),2&o){let l;e.Q6J("ngIf",e.WLB(7,D,null!==(l=e.lcZ(1,1,n.saleList$))&&void 0!==l?l:e.DdM(5,Z),null!==(l=e.lcZ(2,3,n.voucherList$))&&void 0!==l?l:e.DdM(6,Z)))}},dependencies:[c.sg,c.O5,r._Y,r.YN,r.Kr,r.EJ,r.JJ,r.JL,r.sg,r.u,m.A,c.Ov,c.rS,U._]})}return s})()}];let H=(()=>{class s{static#e=this.\u0275fac=function(o){return new(o||s)};static#t=this.\u0275mod=e.oAB({type:s});static#s=this.\u0275inj=e.cJS({imports:[d.Bz.forChild(G),d.Bz]})}return s})();var K=i(165);let $=(()=>{class s{static#e=this.\u0275fac=function(o){return new(o||s)};static#t=this.\u0275mod=e.oAB({type:s});static#s=this.\u0275inj=e.cJS({providers:[L.Q,C.F,y.H,I.Z,K.p,k.K],imports:[c.ez,H,c.ez,F.m,b.JX,M.D,m.A,T.N8]})}return s})()}}]);