"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[309],{4309:(qt,N,s)=>{s.r(N),s.d(N,{InventoryModule:()=>Ct});var d=s(6814),g=s(9772),p=s(9397),G=s(3331),K=s(7101),B=s(694),t=s(9468),J=s(4664),x=s(2096),u=s(2579),P=s(8102),R=s(393);const v=(0,P.MT)({name:"inventory"},(0,u.h4)({idKey:"id"}));(0,R.m)(v,{maxAge:2}).destroy();class m{constructor(){this.inventories$=v.pipe((0,u.WK)())}selectAll(){return this.inventories$}upsertInventories(a){v.update((0,u.g3)(a))}addTodo(a){v.update((0,u.dP)([a]))}updateInventory(a){v.update((0,u.jB)(a.id,a))}deleteInventory(a){v.update((0,u._L)(a))}selectHasCache(){return this.inventories$.pipe((0,J.w)(a=>(0,x.of)(a.length>0)))}getById(a){return v.query((0,u.Hv)(a))}upsertById(a){v.update((0,u.dP)(a))}deleteById(a){v.update((0,u._L)(a))}}var f=s(6232),j=s(8180),Z=s(6306),V=s(5177),X=s(8154),W=s(7283);let L=(()=>{class i{constructor(e,n,o,r){this.router=e,this.store=n,this.CarpetInventoryService=o,this.messageService=r}getAll(){return this.store.selectHasCache().pipe((0,j.q)(1),(0,J.w)(e=>{const n=this.CarpetInventoryService.getAllInventory().pipe((0,Z.K)(o=>(this.messageService.error("Error on getting inventory"),f.E)),(0,p.b)(o=>{this.store.upsertInventories(o)}));return e?(0,x.of)([]):n}),(0,V.g)(0))}upsertInventory(e){return 0===e.id?this.CarpetInventoryService.insertInventory(e).pipe((0,Z.K)(n=>(this.messageService.error("Error on insert inventory"),f.E)),(0,p.b)(n=>{this.store.upsertById(n),console.log(n),this.messageService.success("Inventory Inserted Successfully")})):this.CarpetInventoryService.updateInventory(e).pipe((0,Z.K)(n=>(this.messageService.error("Error on update inventory"),f.E)),(0,p.b)(n=>{this.messageService.success("Inventory Updated Successfully"),console.log(n),this.store.updateInventory(n)}))}deleteInventory(e){this.CarpetInventoryService.deleteInventory(e).pipe((0,Z.K)(n=>(this.messageService.error("Error on delete inventory"),f.E)),(0,p.b)(n=>{this.store.deleteById(e.id),this.messageService.success("Inventory Deleted Successfully")})).subscribe()}static#t=this.\u0275fac=function(n){return new(n||i)(t.LFG(g.F0),t.LFG(m),t.LFG(X.F),t.LFG(W.H))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var I=s(3729),T=s(5872),A=s(4587),q=s(2704),w=s(2051);let tt=(()=>{class i{getGeneratedURL(e){const{bucketName:n,location:o,fileName:r}=function k({bucketName:i="carpets-inventory",location:a="ap-south-1",fileName:e=""}){return{bucketName:i,location:a,fileName:e}}({fileName:e});return r?`https://${n}.s3.${o}.amazonaws.com/${r}`:""}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var F=s(3838),U=s(6472),S=s(7398);let et=(()=>{class i{constructor(e){this.qualityStoreService=e}transform(e){return this.qualityStoreService.selectById(e).pipe((0,S.U)(n=>n?.name??"N/A"))}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(A.t,16))};static#e=this.\u0275pipe=t.Yjl({name:"getQualityById",type:i,pure:!0})}return i})(),it=(()=>{class i{constructor(e){this.designStoreService=e}transform(e){return this.designStoreService.selectById(e).pipe((0,S.U)(n=>n?.name??"N/A"))}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(I.R,16))};static#e=this.\u0275pipe=t.Yjl({name:"getDesignById",type:i,pure:!0})}return i})();var nt=s(2336);function ot(i,a){if(1&i&&(t.TgZ(0,"td")(1,"a",14),t._UZ(2,"i",15),t.qZA()()),2&i){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.s9C("href",n.getImageURL(e.fileKey),t.LSH)}}function rt(i,a){1&i&&(t.TgZ(0,"td"),t._UZ(1,"i",15),t.qZA())}function st(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"titlecase"),t.ALo(6,"async"),t.ALo(7,"getQualityById"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"titlecase"),t.ALo(11,"async"),t.ALo(12,"getDesignById"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"titlecase"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.qZA(),t.TgZ(18,"td"),t._uU(19),t.qZA(),t.YNc(20,ot,3,1,"td",0),t.YNc(21,rt,2,0,"td",0),t.TgZ(22,"td")(23,"i",12),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.navigateInventory(r.id))}),t.qZA(),t.TgZ(24,"i",13),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.openDeleteConfirmationModal(r))}),t.qZA()()()}if(2&i){const e=a.$implicit,n=a.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(t.lcZ(5,8,t.lcZ(6,10,t.lcZ(7,12,e.qualityId)))),t.xp6(5),t.Oqu(t.lcZ(10,14,t.lcZ(11,16,t.lcZ(12,18,e.designId)))),t.xp6(5),t.Oqu(t.lcZ(15,20,e.colorCode)),t.xp6(3),t.Oqu(e.size),t.xp6(2),t.Oqu(e.quantity),t.xp6(1),t.Q6J("ngIf",e.fileKey),t.xp6(1),t.Q6J("ngIf",!e.fileKey)}}function at(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"div",1)(2,"app-card",2),t._UZ(3,"h4",3),t.TgZ(4,"h4",4)(5,"h4"),t._uU(6,"Inventory List"),t.qZA(),t.TgZ(7,"button",5),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.navigateInventory())}),t._UZ(8,"i",6),t._uU(9," Add "),t.qZA()(),t._UZ(10,"hr"),t.TgZ(11,"div",7)(12,"table",8)(13,"thead")(14,"tr")(15,"th"),t._uU(16,"#"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Quality"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Design"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"Color"),t.qZA(),t.TgZ(23,"th"),t._uU(24,"Size"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"Quantity"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"Image"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Action"),t.qZA()()(),t.TgZ(31,"tbody"),t.YNc(32,st,25,22,"tr",9),t.ALo(33,"paginate"),t.ALo(34,"sortDescending"),t.qZA()()(),t.TgZ(35,"div",10)(36,"pagination-controls",11),t.NdJ("pageChange",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.pagingConfig.currentPage=o)}),t.qZA()()()()()}if(2&i){const e=a.ngIf,n=t.oxw();t.xp6(2),t.Q6J("hidHeader",!0)("options",!1),t.xp6(30),t.Q6J("ngForOf",t.xi3(33,3,t.xi3(34,6,e.inventoryList,"desc"),n.pagingConfig))}}const lt=function(){return[]},ct=function(i){return{inventoryList:i}};let dt=(()=>{class i{constructor(e,n,o,r,c,y,h,b,Y){this.router=e,this.store=n,this.service=o,this.designStoreService=r,this.designService=c,this.qualityStoreService=y,this.qualityService=h,this.modalService=b,this.imageService=Y,this.pagingConfig=(0,K.F)({}),this.rowSelection="multiple",this.paginationPageSize=10,this.paginationPageSizeSelector=[10,25,50],this.inventoryList$=this.store.selectAll().pipe((0,p.b)(_=>console.log(_))),this.subscriptions=[],this.message=""}ngOnInit(){this.subscriptions.push(this.service.getAll().subscribe(),this.qualityService.getAll().subscribe(),this.designService.getAll().subscribe())}navigateInventory(e=0){this.router.navigate(["inventory",e])}openDeleteConfirmationModal(e){const n={item:e,message:`delete inventory: ${e.id}`,modalType:B.w.Confirmation},r=this.modalService.show(B.b,{initialState:n,class:"modal-sm modal-dialog-centered"}).content?.onClose.pipe((0,p.b)(c=>{c&&this.service.deleteInventory(e)})).subscribe();r&&this.subscriptions.push(r)}getImageURL(e){return this.imageService.getGeneratedURL(e??"")}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(g.F0),t.Y36(m),t.Y36(L),t.Y36(I.R),t.Y36(T.V),t.Y36(A.t),t.Y36(q.M),t.Y36(w.tT),t.Y36(tt))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-inventory-list"]],viewQuery:function(n,o){if(1&n&&t.Gf(G.Z,5),2&n){let r;t.iGM(r=t.CRH())&&(o.messageDialog=r.first)}},decls:2,vars:6,consts:[[4,"ngIf"],[1,"col-md-12"],["cardTitle","","blockClass","table-border-style",3,"hidHeader","options"],[1,"d-flex"],[1,"text-end","d-flex","flex-row","justify-content-between"],[1,"btn","btn-primary",3,"click"],[1,"feather","icon-plus"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center"],["previousLabel","Prev","nextLabel","Next",3,"pageChange"],["id","actionBtn",1,"feather","icon-edit","m-r-15",3,"click"],["id","actionBtn",1,"feather","icon-trash-2",3,"click"],["target","_blank",3,"href"],[1,"feather","icon-image"]],template:function(n,o){if(1&n&&(t.YNc(0,at,37,9,"div",0),t.ALo(1,"async")),2&n){let r;t.Q6J("ngIf",t.VKq(4,ct,null!==(r=t.lcZ(1,1,o.inventoryList$))&&void 0!==r?r:t.DdM(3,lt)))}},dependencies:[d.sg,d.O5,F.A,U.LS,d.Ov,d.rS,U._s,et,it,nt.K],styles:[".icon-edit[_ngcontent-%COMP%]{color:#00f}.icon-trash-2[_ngcontent-%COMP%]{color:red}#actionBtn[_ngcontent-%COMP%], a[_ngcontent-%COMP%]{cursor:pointer}"]})}return i})();var l=s(95),ut=s(2572);function D({id:i=0,qualityId:a=0,designId:e=0,quantity:n=0,colorCode:o="",size:r="",file:c=new File([],""),name:y="",fileKey:h=""}){return{id:i,qualityId:a,designId:e,quantity:n,colorCode:o,size:r,file:c,name:y,fileKey:h}}var O=s(6178),Q=s(1753),$=s(6414),E=s(6837),H=s(7849);function vt(i,a){if(1&i&&(t.TgZ(0,"option",22),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.Oqu(e.name)}}function pt(i,a){if(1&i&&(t.TgZ(0,"option",22),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.Oqu(e.name)}}function gt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.uppertInventory())}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("disabled",e.inventoryForm.invalid),t.xp6(1),t.Oqu(0===e.inventoryForm.value.id?"Save":"Update")}}function yt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"div",1)(2,"app-card",2)(3,"form",3)(4,"h5"),t._uU(5),t.qZA(),t._UZ(6,"hr"),t.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"label",7),t._uU(11,"Quality"),t.TgZ(12,"span",8),t._uU(13,"*"),t.qZA()(),t.TgZ(14,"select",9)(15,"option",10),t._uU(16,"Select"),t.qZA(),t.YNc(17,vt,2,2,"option",11),t.qZA()()(),t.TgZ(18,"div",5)(19,"div",6)(20,"label",12),t._uU(21,"Design"),t.TgZ(22,"span",8),t._uU(23,"*"),t.qZA()(),t.TgZ(24,"select",13)(25,"option",10),t._uU(26,"Select"),t.qZA(),t.YNc(27,pt,2,2,"option",11),t.qZA()()(),t.TgZ(28,"div",5)(29,"div",6)(30,"label",12),t._uU(31,"Colour"),t.TgZ(32,"span",8),t._uU(33,"*"),t.qZA()(),t._UZ(34,"input",14),t.qZA()(),t.TgZ(35,"div",5)(36,"div",6)(37,"label",15),t._uU(38,"Size"),t.TgZ(39,"span",8),t._uU(40,"*"),t.qZA()(),t._UZ(41,"input",16),t.qZA()(),t.TgZ(42,"div",5)(43,"div",6)(44,"label",17),t._uU(45,"Quantity"),t.qZA(),t._UZ(46,"input",18),t.qZA()(),t.TgZ(47,"div",5)(48,"div",6)(49,"label",17),t._uU(50,"Image"),t.qZA(),t.TgZ(51,"input",19),t.NdJ("change",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onFileSelected(o))}),t.qZA()()()()(),t.TgZ(52,"div",1)(53,"button",20),t._uU(54,"Cancel"),t.qZA(),t.YNc(55,gt,2,2,"button",21),t.qZA()()()()}if(2&i){const e=a.ngIf,n=t.oxw();t.xp6(2),t.Q6J("hidHeader",!0)("options",!1),t.xp6(1),t.Q6J("formGroup",n.inventoryForm),t.xp6(2),t.hij("",0===n.inventoryForm.value.id?"Add":"Edit"," Inventory"),t.xp6(12),t.Q6J("ngForOf",e.qualityList),t.xp6(10),t.Q6J("ngForOf",e.designList),t.xp6(7),t.Q6J("typeahead",e.colorList),t.xp6(7),t.Q6J("typeahead",e.sizeList),t.xp6(12),t.Q6J("routerLink","/inventory"),t.xp6(2),t.Q6J("ngIf",n.inventoryForm.dirty)}}const C=function(){return[]},ht=function(i,a,e,n){return{qualityList:i,designList:a,colorList:e,sizeList:n}},mt=[{path:"",component:dt},{path:":id",component:(()=>{class i{get masterId(){return this.inventoryForm.get("masterId")}get id(){return this.inventoryForm.get("id")}get quality(){return this.inventoryForm.get("quality")}get design(){return this.inventoryForm.get("design")}get quantity(){return this.inventoryForm.get("quantity")}get color(){return this.inventoryForm.get("color")}get size(){return this.inventoryForm.get("size")}get file(){return this.inventoryForm.get("file")}get name(){return this.inventoryForm.get("name")}constructor(e,n,o,r,c,y,h,b,Y,_,xt,Lt,Tt){this.route=e,this.formBuilder=n,this.store=o,this.inventoryService=r,this.qualityService=c,this.qualityStoreService=y,this.designService=h,this.designStoreService=b,this.colorService=Y,this.colorStoreService=_,this.sizeService=xt,this.sizeStoreService=Lt,this._router=Tt,this.subscriptions=[],this.qualityList$=this.qualityStoreService.selectAll(),this.designList$=this.designStoreService.selectAll(),this.colorList$=this.colorStoreService.selectAll().pipe((0,S.U)(z=>z.map(M=>M.name))),this.sizeList$=this.sizeStoreService.selectAll().pipe((0,S.U)(z=>z.map(M=>M.name))),this.inventoryForm=this.formBuilder.nonNullable.group({masterId:[0],id:[0],quality:[0,l.kI.required],design:[0,l.kI.required],quantity:[1,l.kI.required],color:["",l.kI.required],size:["",l.kI.required],file:[""],name:[""]})}ngOnInit(){this.subscriptions.push((0,ut.a)([this.route.params,this.inventoryService.getAll(),this.qualityService.getAll(),this.colorService.getAll(),this.sizeService.getAll(),this.designService.getAll()]).pipe((0,p.b)(([e])=>{if(e.id){const n=Number(e.id),o=this.store.getById(n)??D({});console.log(o),this.inventoryForm.setValue({masterId:o.masterId,id:o.id,quality:o.qualityId,design:o.designId,color:o.colorCode,size:o.size,quantity:o.quantity,file:new File([],""),name:""})}})).subscribe())}uppertInventory(){const e=D({id:this.id.value,qualityId:this.quality.value,designId:this.design.value,quantity:this.quantity.value,colorCode:this.color.value,size:this.size.value,file:this.file.value});(this.inventoryForm.valid||this.inventoryForm.disabled)&&this.subscriptions.push(this.inventoryService.upsertInventory(e).pipe((0,p.b)(()=>{this.inventoryForm.markAsPristine(),this.navigate()})).subscribe())}navigate(){this._router.navigate(["/inventory"])}cancel(){}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}onFileSelected(e){e.target instanceof HTMLInputElement&&e.target.files?.length&&this.file.setValue(e.target.files[0])}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(g.gz),t.Y36(l.qu),t.Y36(m),t.Y36(L),t.Y36(q.M),t.Y36(A.t),t.Y36(T.V),t.Y36(I.R),t.Y36(O.x),t.Y36(Q.h),t.Y36($.Z),t.Y36(E.A),t.Y36(g.F0))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-inventory-detail"]],decls:5,vars:18,consts:[[4,"ngIf"],[1,"col-md-12"],["cardTitle","",3,"hidHeader","options"],[3,"formGroup"],[1,"row"],[1,"col-md-6"],[1,"form-group"],["for","quality"],[1,"required"],["id","quality","formControlName","quality",1,"form-control"],["value","0","disabled",""],[3,"value",4,"ngFor","ngForOf"],["for","design"],["id","design","formControlName","design",1,"form-control"],["type","text","id","city","placeholder","Ex: Blue","formControlName","color",1,"form-control","text-capitalize",3,"typeahead"],["for","size"],["type","text","id","size","placeholder","Ex: 5*6","formControlName","size",1,"form-control",3,"typeahead"],["for","quantity"],["type","number","id","quantity","placeholder","Ex: 1","formControlName","quantity",1,"form-control"],["type","file","id","quantity","formControlName","file",1,"form-control",3,"change"],["type","button",1,"btn","btn-outline-primary","m-r-15",3,"routerLink"],["type","button","class","btn btn-primary",3,"disabled","click",4,"ngIf"],[3,"value"],["type","button",1,"btn","btn-primary",3,"disabled","click"]],template:function(n,o){if(1&n&&(t.YNc(0,yt,56,10,"div",0),t.ALo(1,"async"),t.ALo(2,"async"),t.ALo(3,"async"),t.ALo(4,"async")),2&n){let r;t.Q6J("ngIf",t.l5B(13,ht,null!==(r=t.lcZ(1,1,o.qualityList$))&&void 0!==r?r:t.DdM(9,C),null!==(r=t.lcZ(2,3,o.designList$))&&void 0!==r?r:t.DdM(10,C),null!==(r=t.lcZ(3,5,o.colorList$))&&void 0!==r?r:t.DdM(11,C),null!==(r=t.lcZ(4,7,o.sizeList$))&&void 0!==r?r:t.DdM(12,C)))}},dependencies:[d.sg,d.O5,g.rH,l._Y,l.YN,l.Kr,l.Fj,l.wV,l.EJ,l.JJ,l.JL,l.sg,l.u,F.A,H.Bp,d.Ov],styles:[".required[_ngcontent-%COMP%]{color:red}"]})}return i})()}];let ft=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[g.Bz.forChild(mt),g.Bz]})}return i})();var Zt=s(6208),It=s(2524),At=s(1088),St=s(3026);let Ct=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({providers:[m,L,A.t,q.M,T.V,I.R,Q.h,O.x,E.A,$.Z],imports:[d.ez,ft,d.ez,Zt.m,U.JX,It.D,F.A,At.N8,H.H3,St.Gs]})}return i})()}}]);